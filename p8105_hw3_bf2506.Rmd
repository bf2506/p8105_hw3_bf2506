---
title: "p8105_hw3_bf2506.Rmd"
output: github_document
date: "2022-10-10"
---
```{r load package, message=FALSE, warning=FALSE}
library(tidyverse)
```

### Problem 2
##### Load, tidy, and wrangle accel_data
```{r read, message=FALSE, warning=FALSE}
accel_data = 
  read.csv("./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(weekday_vs_weekend = ifelse(day == c("Saturday", "Sunday"), "weekend", "weekday")) %>% 
  select(week, day_id, day, weekday_vs_weekend, everything())

```
**Describe the accel_data**
There are `r nrow` observations and `r ncol` variables. <br>
Variables: "week", "day_id", "day", "weekday_vs_weekend", "activity_*"(from "activity_1" to "activity_1440") <br>

##### Traditional analyses of accel_data

```{r create a total activity variable for each day}
accel_data = 
  mutate(accel_data, total_activity = rowSums(accel_data[5:1444])) %>% 
  select(week, day_id, day, weekday_vs_weekend, total_activity, everything())
```

```{r create new total table }
total_activity_table =
  select(accel_data, week, day_id, day, weekday_vs_weekend, total_activity) %>% 
  mutate(day = fct_relevel(day, c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))) %>% 
  arrange(week, day)

df= 
  select(total_activity_table, total_activity)
df
```
**Trend**
The man is more active from week 1 to week 3, and is less active from week 4 to week 5. On average, he is more active on Friday. Considering the two outliers data we found on Saturday in week 4 and week 5, there may be some mistakes. But there is no obvious monotonically increasing or decreasing trend.

##### Make a single-panel plot

```{r single-panel plot}
plot_df = 
   pivot_longer(
    accel_data,
    activity_1:activity_1440, 
    names_to = "activity_No", 
    values_to = "activity_counts")

hour_activity_plot = 
    ggplot(plot_df, aes(x = activity_No, y = activity_counts, color = day)) + 
  geom_point() + 
  theme(legend.position = "bottom", axis.text.x = element_blank()) + 
  labs(title = " Accelerometer Activity Counts by Day", x = "Time", y = "Activity_Counts") 

hour_activity_plot
```
**Describe the graph**
We can conclude that the man is usually active on the Friday morning and on the Sunday evening, less active on Wednesday. 

### Problem 3

```{r load dataset of noaa}
library(p8105.datasets)
data("ny_noaa")
```
**Describe ny_noaa ** < br >
This dataset contains 2595176 observations and 7 variables related to some weather data in New York, which are provided by NOAA. ??many stations report precipitation only.??indicating the extent to which missing data is an issue.??
The Variables are as following: <br>
      id: Weather station ID <br>
      date: Date of observation <br>
      prcp: Precipitation (tenths of mm) <br>
      snow: Snowfall (mm) <br>
      snwd: Snow depth (mm) <br>
      tmax: Maximum temperature (tenths of degrees C) <br>
      tmin: Minimum temperature (tenths of degrees C) <br>

